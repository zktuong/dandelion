[tool.black]
line-length = 80
target-version = ['py38']
include = '\.pyi?$'
exclude = '''

(
  /(
      \.eggs         # exclude a few common directories in the
    | \.git          # root of the project
    | \.hg
    | \.mypy_cache
    | \.tox
    | \.venv
    | _build
    | buck-out
    | build
    | dist
  )/
  | foo.py           # also separately exclude a file named foo.py in
                     # the root of the project
)
'''

[tool.interrogate]
ignore-init-method = true
ignore-init-module = false
ignore-magic = false
ignore-semiprivate = false
ignore-private = false
ignore-property-decorators = false
ignore-module = true
fail-under = 100
exclude = [
  "setup.py",
  "docs",
  "build",
  "data",
  "bin",
  "dandelion/external",
  "tests",
]
ignore-regex = ["^get$", "^mock_.*", ".*BaseClass.*"]
verbose = 2
quiet = false
whitelist-regex = []
color = true

[tool.pytest.ini_options]
addopts = "--cov --cov-report term-missing"
testpaths = ["tests"]

[build-system]
requires = ["setuptools>=45", "wheel", "setuptools_scm[toml]>=6.0"]
build-backend = "setuptools.build_meta"

[project]
name = "sc-dandelion"
dynamic = ["version"]
version = { use_scm = true }
authors = [{ name = "zktuong", email = "z.tuong@uq.edu.au" }]
description = "sc-TCR/BCR-seq analysis tool"
readme = "README.md"
readme-content-type = "text/markdown"
license = { text = "GNU Affero General Public License v3 or later (AGPLv3+)" }
homepage = "https://github.com/zktuong/dandelion/"
classifiers = [
  "Programming Language :: Python :: 3.10",
  "Programming Language :: Python :: 3.11",
  "Programming Language :: Python :: 3.12",
  "License :: OSI Approved :: GNU Affero General Public License v3 or later (AGPLv3+)",
]
keywords = ["dandelion", "single-cell", "immune", "TCR", "BCR"]

[tool.setuptools_scm]
write_to = "dandelion/logging/version.py"
write_to_template = "# coding: utf-8\n# file generated by setuptools_scm\n# don't change, don't track in version control\n__version__ = '{version}'.split('+')[0]"
tag_regex = "^(?P<prefix>v)?(?P<version>[^\\+]+)(?P<suffix>.*)?$"

[project.dependencies]
# Dependencies are dynamically loaded from requirements.txt

[project.optional-dependencies]
docs = [
  "airr",
  "biopython",
  "changeo",
  "presto",
  "pyyaml",
  "yamlordereddictloader",
  "sphinx<7",
  "nbsphinx<=0.9.2",
  "sphinx-autodoc-typehints<=2.5.0",
  "sphinx_rtd_theme<=3.0.2",
  "readthedocs-sphinx-ext<=2.2.5",
  "recommonmark<=0.7.1",
]
scirpy = ["scirpy<=0.20.0", "awkward", "mudata"]

[tool.setuptools]
packages = ["dandelion"]
include_package_data = true
package_data = { "dandelion" = [
  "bin/tigger-genotype.R",
  "bin/MakeDb_gentle.py",
] }
data_files = [["bin", ["bin/tigger-genotype.R", "bin/MakeDb_gentle.py"]]]
zip_safe = false
